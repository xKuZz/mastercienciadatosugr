## ----setup, include=FALSE------------------------------------------------
knitr::opts_chunk$set(echo = TRUE)


## ------------------------------------------------------------------------
dim(USArrests)


## ------------------------------------------------------------------------
length(USArrests)


## ------------------------------------------------------------------------
ncol(USArrests)


## ------------------------------------------------------------------------
nrow(USArrests)


## ------------------------------------------------------------------------
rownames(USArrests)


## ------------------------------------------------------------------------
colnames(USArrests)


## ------------------------------------------------------------------------
head(USArrests, 6)


## ------------------------------------------------------------------------
x <- USArrests
x <- x[order(x$UrbanPop, decreasing=T),]
head(x, )


## ------------------------------------------------------------------------
y <- USArrests
y <- y[order(y$UrbanPop, y$Murder, decreasing=T),]
head(y, 10)


## ------------------------------------------------------------------------
USArrests$Murder


## ------------------------------------------------------------------------
USArrests$Murder[2:4]


## ------------------------------------------------------------------------
USArrests[1:5, ]


## ------------------------------------------------------------------------
USArrests[,1:2]


## ------------------------------------------------------------------------
USArrests[,c(1,3)]


## ------------------------------------------------------------------------
USArrests[1:5,1:2]


## ------------------------------------------------------------------------
USArrests$Murder


## ------------------------------------------------------------------------
rownames(USArrests)[which.min(USArrests$Murder)]


## ------------------------------------------------------------------------
rownames(USArrests)[USArrests$Murder < 4]


## ------------------------------------------------------------------------
rownames(USArrests)[USArrests$UrbanPop > 75]


## ------------------------------------------------------------------------
CO2[order(as.character(CO2$Plant)),]


## ------------------------------------------------------------------------
CO2[order(CO2$uptake, as.character(CO2$Plant)),]


## ------------------------------------------------------------------------
CO2[c(order(CO2$uptake), order(as.character(CO2$Plant), decreasing=T)),]


## ------------------------------------------------------------------------
class(state.x77)

## ------------------------------------------------------------------------
df <- as.data.frame(state.x77)
class(df)


## ------------------------------------------------------------------------
rownames(subset(df, df$Income < 4300))


## ------------------------------------------------------------------------
rownames(df)[which.max(df$Income)]


## ------------------------------------------------------------------------
df2 <- cbind(state.abb, state.area, state.division, state.region)
df2 <- as.data.frame(df2, row.names=state.name)


## ------------------------------------------------------------------------
names(df2) <- gsub("state.", "", names(df2))
names(df2)


## ------------------------------------------------------------------------
df2$division <- NULL


## ------------------------------------------------------------------------
df <- cbind(df, df2)
df$`HS Grad` <- NULL
df$`Life Exp` <- NULL
df$Frost <- NULL
df$abb <- NULL
df$area <- NULL


## ------------------------------------------------------------------------
df$CutVersion <- cut(df$Illiteracy, breaks=c(0,1,2,Inf), 
                     labels=c("low", "some", "high"))
df$CutVersion


## ------------------------------------------------------------------------
df$IfElseVersion <- factor(ifelse(df$Illiteracy < 1, "low",
                           ifelse(df$Illiteracy < 2, "some", "high")))
df$IfElseVersion


## ------------------------------------------------------------------------
x <- subset(df, df$region==4)
rownames(x)[which.min(x$Illiteracy)]
rownames(x)[which.max(x$Income)]


## ------------------------------------------------------------------------
x


## ------------------------------------------------------------------------
library("hflights")
library("dplyr")

## ------------------------------------------------------------------------
df <- hflights
names(df)


## ------------------------------------------------------------------------
df %>% filter(DayofMonth==1 & Month==1) %>% select(Month, DayofMonth, FlightNum) %>% 
  head(., 20)


## ------------------------------------------------------------------------
df %>% filter(UniqueCarrier %in% c("AA", "UA")) %>% select(UniqueCarrier, FlightNum) %>%
  head(., 20)


## ------------------------------------------------------------------------
df2 <- df %>% select(FlightNum, DepTime, ArrTime)


## ------------------------------------------------------------------------
df %>% select(grep("*Taxi*|*Delay*", names(df))) %>% head(10)


## ------------------------------------------------------------------------
df %>% select(UniqueCarrier, DepDelay) %>% 
       filter(DepDelay > 60) %>%
       arrange(desc(DepDelay)) %>% head(20)


## ------------------------------------------------------------------------
df <- df %>% mutate(mph = Distance/ActualElapsedTime)
head(df$mph, 10)


## ------------------------------------------------------------------------
df %>% group_by(Dest) %>% summarize(Media = mean(ArrDelay, na.rm=T))


## ------------------------------------------------------------------------
df %>% group_by(UniqueCarrier) %>% 
  slice(which.max(DepDelay), which.min(DepDelay), 
        which.max(ArrDelay), which.min(ArrDelay))


## ------------------------------------------------------------------------
students <- read.table("student.txt",header=T)
students


## ------------------------------------------------------------------------
names(students)


## ------------------------------------------------------------------------
students$height


## ------------------------------------------------------------------------
table(students$gender)

## ------------------------------------------------------------------------
table(students$population)

## ------------------------------------------------------------------------
table(students$height, students$shoesize)


## ------------------------------------------------------------------------
students.new <- as.data.frame(students) %>%
    mutate(sym = ifelse(gender == "male", "M", "F")) %>%
    mutate(colours = ifelse(population == "kuopio", "Blue", "Red")) %>%
    select(height, shoesize, sym, colours)
head(students.new)


## ------------------------------------------------------------------------
class(students.new)


## ------------------------------------------------------------------------
student <- as.data.frame(students)
subset1 <- which(student$gender=="male")


## ------------------------------------------------------------------------
student.male <- student[subset1,]
student.male


## ------------------------------------------------------------------------
student.female = student[-subset1,]
student.female


## ------------------------------------------------------------------------
write.table(students.new, "student_new.txt")

